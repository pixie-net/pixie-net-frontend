{% extends 'base.html' %}
{% block page_title %} DAQ {% endblock %}

{% block main_panel %}
    <div class="main-panel">
        <div class="panel-header">
            <div class="header text-center">
                <h1 class="title">Pixie-Net Data Acquisition Control</h1>
            </div>
        </div>
        <div class="content">
            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <h2>DAQ Control</h2>
                            </div>
                        </div>
                        <div class="card-body">
                            <input id='read' type="button" value="Read Settings">
                            <input id='apply' type="button" value="Apply">
                            <input id='start' type="button" value="Start DAQ">
                            <p></p>

                            <div id="myProgress">
                                <div id="myBar"></div>
                            </div>

                            <table>
                                <tr id=row00>
                                    <td>REQ_RUNTIME (s)</td>
                                    <td><input class="field" type="text" size="8" id="runtime"
                                               value="0"></td>
                                </tr>
                                <tr id=row01>
                                    <td>RUN_TYPE</td>
                                    <td><input class="field" type="text" size="8" id="runtype"
                                               value="0x400"></td>
                                </tr>
                            </table>
                            <p></p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-md-offset-6">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <h2>Results</h2>
                            </div>
                        </div>
                        <div class="card-body">
                            These links point to files generated by the DAQ (startdaq, acquire,
                            etc). Clicking on
                            them will prompt for download action.
                            <ul>
                                <li><a href="LMdata.txt"> List mode data with waveforms </a>(from
                                    run type 0x500,
                                    text)
                                </li>
                                <li><a href="LMdata.dat"> List mode data without waveforms </a>(from
                                    run type 0x501,
                                    csv)
                                </li>
                                <li><a href="LMdata.dt2"> List mode data with PSA </a>(from run type
                                    0x502, csv)
                                </li>
                                <li><a href="LMdata.dt3"> List mode coincidence data </a>(from run
                                    type 0x503, csv)
                                </li>
                                <li><a href="LMdata.b00"> Binary list mode data </a>(from run types
                                    0x400, 0x402)
                                </li>
                                <li><a href="MCA.csv"> MCA spectra </a> as csv file</li>
                                <li><a href="RS.csv"> Run statistics </a> as csv file (full)</li>
                                <li><a href="psa2D.csv"> PSA histogram </a> as csv file</li>
                            </ul>
                            <p>View most recent data<b> in plots and tables</b></p>
                            <ul>
                                <li><a href="mca.html">MCA spectra</a>
                                <li><a href="run_stats.html">Run status</a>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        var i = 0;

        function move() {
            if (i == 0) {
                i = 1;
                var elem = document.getElementById("myBar");
                var width = 1;
                var id = setInterval(frame, $("#runtime").val() * 10);

                function frame() {
                    if (width >= 100) {
                        clearInterval(id);
                        i = 0;
                    } else {
                        width++;
                        elem.style.width = width + "%";
                    }
                }
            }
        }
    </script>
{% endblock %}
